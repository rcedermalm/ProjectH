<head>
  <script src="Script/typeahead.js"></script>
  <script src="Script/bootstrap-tagsinput.js"></script>
  <script src="Script/upload.js"></script> 
 </head>
<h1 id="heading-browse">Add files to the database</h1>



<div class="container">
  <div class="row">
    <div class="col-xs-12">
      <div class="panel panel-primary">
        <div class="panel-heading">
          <button class="btn-sm upload-btn pull-left" type="button">
          <span class="glyphicon glyphicon-upload" id="select-files-icon"></span>Select files</button>
        </div>  
        <div class="panel-body">
          <!--
          <div class="progress">
           <div class="progress-bar" role="progressbar"></div>
          </div> -->
        </div>
      </div>
    </div>
  </div>
</div>

<!-- <input id="upload-input" type="file" name="uploads[]" multiple="multiple"></br>

Select files 
<div class="fileinput fileinput-new" data-provides="fileinput">
  <input type="file" class="btn btn-default btn-browse" id="files" name="files[]" multiple />
  <output id="list"></output>
</div> -->


<!-- User input -->
<div ng-controller="AddController">

  <form ng-submit="processForm()">
    <div>
      <label for="directory" class="txt-info">Folder directory:</label>
      <input type="text" class="txt-field" ng-model="inputDirectory" id="directory-init" required>
      {{content}}
    </div>
    <div >
      <label for="types" class="txt-info">Data Types:</label>
      <input type="text" class="txt-field" ng-model="inputTags" id="labels-init">
    </div>

    <div>
      <!-- old id: creator -->
      <label for="creator" class="txt-info">Creator:</label>
        <input type="text" ng-model="Info.Creator" class="txt-field" id="creator-init">
    </div>

    <div>
      <!-- old id: infoTestData -->
      <label for="infoTestData" class="txt-info">TestData ID:</label>
      <input type="text" ng-model="Info.TestDataID" class="txt-field" id="TDID-init">
    </div>

    <div>
      <!-- old id: infoTestCase -->
      <label for="infoTestCase" class="txt-info">TestCase ID:</label>
      <input type="text" ng-model="Info.TestCaseID"  class="txt-field" id="TCID-init">
    </div>

    <div>
      <!-- old id: patient-name -->
      <label for="patient-name" class="txt-info">New patient name:</label>
      <input type="text" ng-model="Info.NewPatientName" class="txt-field" id="patient-name-init">
    </div>

    <div>
      <!-- old id: tags -->
      <label for="tags" class="txt-info">Labels:</label>
      <input type="text" id="tags" value="" data-role="tagsinput" id="tags-init" class="form-control" ng-model="Tags" ng-init="Tags=''">
    </div>

    <div>
      <!-- old id: comments -->
      <label for="comments" class="txt-info">Comments:</label>
      <textarea type="text" class="txt-area" id="comments-init" ng-model="Info.Comments" placeholder="Info"></textarea>
    </div>

    <div>
      <label for="anonymized" class="txt-info">Anonymized?</label>
      <label class="switch">
        <input type="checkbox" ng-model="Info.Anonymized" ng-init="Info.Anonymized='false'" id = "anonymized-init">
        <div class="slider"></div>
      </label>
    </div>

    <!-- Custom Fields -->
    <div class="row">
    <input type="hidden" name="count" value="1" />
        <div class="control-group" id="fields">
            <label class="txt-info" for="field1">Custom Fields</label>
            <div class="controls" id="profs"> 
                <form>
                    <div id="field">
                      <input class="txt-field" id="field1" name="prof1" type="text" placeholder="Key" data-items="8"/>
                      <!--<input class="tex-field" id="field21" name="prof21" type="text" placeholder="Value" data-items="8"/>-->
                      <button id="b1" class="btn add-more" type="button">+</button>
                    </div>
                </form>
            </div>
        </div>
  </div>

    <div class="buttons">
      <button type="button" class="btn btn-cancel">Cancel</button>
      <!--<button type="submit" class="btn btn-import">Add entry</button>  
      <button ng-click="SendData()" type="submit" class="btn btn-import">Add entry</button> -->   
      <button class="btn btn-import" data-toggle="modal" data-target="#register" onclick="modalFunction()">Proceed</button>
    </div>
  </form>

  <script>

  //JQuery 
    $(document).ready(function(){
    var next = 1;
    $(".add-more").click(function(e){
        e.preventDefault();
        //Current key value text field, add more after the current one
        var addto = "#field" + next; // Ex field2, field3, field4
        var addRemove = "#field" + (next); // Ex ????

        next = next + 1;
        // New key value text field to be added after current
        var newIn = '<input class="txt-field" id="field' + next + '" name="field' + next + '" type="text" placeholder="Key">';
        var newInput = $(newIn);

        //Delete button to be added after new key value text field
        var removeBtn = '<button id="remove' + (next - 1) + '" class="btn btn-danger remove-me" >-</button></div><div>';
        var removeButton = $(removeBtn);

        //Add new KV after current
        $(addto).after(newInput);
        $(addRemove).after(removeButton);
        $("#field" + next).attr('data-source',$(addto).attr('data-source'));
        $("#count").val(next);  
        
            $('.remove-me').click(function(e){
                e.preventDefault();
                var fieldNum = this.id.charAt(this.id.length-1);
                var fieldID = "#field" + fieldNum;
                $(this).remove();
                $(fieldID).remove();
            });
    }); 
});

  </script>



  <!-- Modal -->
  <div class="modal fade" id="register" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Overview</h4>
        </div>
        <div class="modal-body">

          <div>
            <label for="directory" class="txt-info">Folder directory:</label>
            <input id="directory" name="directory" type="text" value="{{ request.form.directory }}" disabled/>
          </div>

          <div >
            <label for="types" class="txt-info">Data Types:</label>
            <input id="labels" name="labels" type="text" value="{{ request.form.labels }}" disabled/>
          </div>

          <div>
            <label for="creator" class="txt-info">Creator:</label>
            <input id="creator" name="creator" type="text" value="{{ request.form.creator }}" disabled/>
          </div>

          <div>
            <label for="infoTestData" class="txt-info">TestData ID:</label>
            <input id="TDID" name="TDID" type="text" value="{{ request.form.TDID }}" disabled/>
          </div>

          <div>
            <label for="infoTestCase" class="txt-info">TestCase ID:</label>
            <input id="TCID" name="TCID" type="text" value="{{ request.form.TCID }}" disabled/>
          </div>

          <div>
            <label for="patient-name" class="txt-info">New patient name:</label>
            <input id="patient-name" name="patient-name" type="text" value="{{ request.form.patient-name }}" disabled/>
          </div>

         <!-- <div>
            <label for="tags" class="txt-info">Labels:</label>
            <input id="tags" name="tags" type="text" value="{{ request.form.tags }}" disabled/>
          </div> -->

          <div>
            <label for="comments" class="txt-info">Comments:</label>
            <input id="comments" name="comments" type="text" value="{{ request.form.comments }}" disabled/>
          </div>

          <!-- <div>
            <label for="anonymized" class="txt-info">Anonymized:</label>
            <input id="anonymized" name="anonymized" type="text" value="{{ request.form.anonymized }}" disabled/>
          </div> -->

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          <button ng-click="SendData()" type="submit" class="btn btn-default">Add entry</button> 
        </div>
      </div>
    </div>
  </div>
</div>
